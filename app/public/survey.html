<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Survey Page</title>

  <!-- Latest compiled and minified CSS & JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

  <style>
    /* The Modal (background) */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0,0,0); /* Fallback color */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content/Box */
.modal-content {
    background-color: #fefefe;
    margin: 15% auto; /* 15% from the top and centered */
    padding: 20px;
    border: 1px solid #888;
    width: 80%; /* Could be more or less, depending on screen size */
}

/* The Close Button */
.close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}

.close:hover,
.close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}
  </style>



</head>

<body>

  <div class="container">

    <div class="jumbotron">
      <h1 class="text-left"><span class="fa fa-child"></span>Friend Finder</h1>
      <hr>
      <h2 class="text-left">
        Survey Questions
      </h2>
      <br>

    </div>


    <div class="row">
      <div class="col-lg-12">
        <!-- Reservation Page -->
        <div class="card">
          <div class="card-header">
            <h3>About You</h3>
          </div>
          <div class="card-body">
            <form role="form">
              <div class="form-group">
                <label for="reserve-name">Name</label>
                <input type="text" class="form-control" id="survey-name">
              </div>
              <div class="form-group">
                <label for="reserve-phone">Link to Photo Image (Required)</label>
                <input type="text" class="form-control" id="survey-photo">
              </div>

            </form>
          </div>
          <div class="card-body questions">
          </div>

          <button type="submit" class="btn btn-primary submit" id="myBtn">Submit</button>

        </div>
      </div>
    </div>

    <!-- The Modal -->

    <div id="myModal" class="modal">

      <!-- Modal content -->
      <div class="modal-content">
        <span class="close">&times;</span>
        <div class="modal-header">
          <h2 class="modal-title"><strong>Closest Match!</strong></h2>
        </div>
        <div class="modal-body">
          <h2 id="friendName"></h2>
          <img id="friendPhoto" src="" alt="">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary close" data-dismiss="modal">Close</button>
        </div>
      </div>

    </div>


    <footer class="footer">
      <div class="container">
        <p><a href="/api/friends">API Friends List</a> |
          <a href="https://github.com/Shahriar87/FriendFinder">GitHub Repo</a>
      </div>
    </footer>

  </div>

</body>


</html>

<!-- BELOW CODE IS CRITICAL. IT HANDLES HOW FORM DATA IS SENT TO OUR SERVER -->
<script type="text/javascript">

  var questionData = [
    "Your mind is always buzzing with unexplored ideas and plans.",
    "Generally speaking, you rely more on your experience than your imagination.",
    "You find it easy to stay relaxed and focused even when there is some pressure.",
    "You rarely do something just out of sheer curiosity.",
    "People can rarely upset you.",
    "It is often difficult for you to relate to other people’s feelings.",
    "In a discussion, truth should be more important than people’s sensitivities.",
    "You rarely get carried away by fantasies and ideas.",
    "You think that everyone’s views should be respected regardless of whether they are supported by facts or not.",
    "You feel more energetic after spending time with a group of people."
  ];

  for (var i = 0; i < questionData.length; i++) {
    $(".questions").append(

      "<div><h3><strong>Question " +
      (i + 1) + "</strong></h3><h5>" + questionData[i] + "</h5><select class='chosen-select' id='q" + (i + 1)
      + "'><option value=''></option><option value='1'>1 (Strongly Disagree)</option><option value='2'>2</option><option value='3'>3</option><option value='4'>4</option><option value='5'>5 (Strongly Agree)</option></div>"
    )
  };

  $(".submit").on("click", function (event) {
    event.preventDefault();
    // GRAB DATA FOR NEW FRIEND ENTRY
    var newFriend = {
      name: $("#survey-name").val().trim(),
      photo: $("#survey-photo").val().trim(),
      scores: [
        $("#q1").val(),
        $("#q2").val(),
        $("#q3").val(),
        $("#q4").val(),
        $("#q5").val(),
        $("#q6").val(),
        $("#q7").val(),
        $("#q8").val(),
        $("#q9").val(),
        $("#q10").val()
      ]
    }
    console.log(newFriend);

    $.post("/api/friends", newFriend, function (data) {

    });

    $("#survey-name").val("");
    $("#survey-photo").val("");
    $("#q1").val("");
    $("#q2").val("");
    $("#q3").val("");
    $("#q4").val("");
    $("#q5").val("");
    $("#q6").val("");
    $("#q7").val("");
    $("#q8").val("");
    $("#q9").val("");
    $("#q10").val("");

  });

  // Get the modal
  var modal = document.getElementById('myModal');

  // Get the button that opens the modal
  var btn = document.getElementById("myBtn");

  // Get the <span> element that closes the modal
  var span = document.getElementsByClassName("close")[0];

  // When the user clicks on the button, open the modal 
  btn.onclick = function () {
    modal.style.display = "block";
  }

  // When the user clicks on <span> (x), close the modal
  $('.close').on("click ", function () {
    modal.style.display = "none";
  });


    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function (event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    }


</script>